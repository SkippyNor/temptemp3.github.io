<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>bash script coding style guide | temptemp3.github.io</title>

<link rel="canonical" href="https://temptemp3.github.io/bash-script-coding-style-guide.html" />
<link rel="stylesheet" href="css/w3.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway">
<style>
body,h1,h2,h3,h4,h5 {font-family: "Raleway", sans-serif}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-104620931-1', 'auto');
  ga('send', 'pageview');
</script>
</head>
<body class="w3-light-grey">
<div class="w3-content" style="max-width:1400px">
<!-- Header -->
<header class="w3-container w3-center w3-padding-32"> 
<h1><b><a style="text-decoration:none;" href="https://temptemp3.github.io/">tempt2<sup>3</sup></a></b></h1>
<p>Welcome to the blog of <span class="w3-tag"><a style="text-decoration:none;" href="https://github.com/temptemp3">temptemp3</a></span></p>
</header>
<!-- begin Grid -->
<div class="w3-row">
<div class="w3-col l8 s12">
<div class="w3-card-4 w3-margin w3-white">
<div class="w3-container">
<h1>bash script coding style guide</h1>

<!--
[bash script coding style guide](bash-script-coding-style-guide.html)
-->

<p>You are in search of a bash scripting guide written for all kinds of scripters to help you do more writing less code.</p>

<hr />

<p>Here is a bash script coding style guide to be updated on a continual basis covering bash coding style points by temptemp3 subject to revision without notice.</p>

<h2>${0} - bash script guide: coding + style</h2>

<p>Unlike <a href="links.html#shell-style-guides">other shell style guides</a> out there, this guide includes coding in addition to style points which will be explained briefly by example. Comparisons with other style guides may be made.</p>

<h3>coding</h3>

<p>points relevant to what happens outside code</p>

<h4>example: files and interpreter / file extensions</h4>

<h5>temptemp3</h5>

<p>All executables and libraries should have a .sh extension and may be executable. Files and executability are treated mutually exclusive; i.e. executability is not taken into consideration in the naming of a bash program file.</p>

<h5>google</h5>

<p>No extension preferred except for library files else use .sh extension.</p>

<h3>style</h3>

<p>points relevant to what happens inside code</p>

<h4>example: formatting / indentation</h4>

<h5>temptemp3</h5>

<p>Indent 1 space. No tabs.</p>

<h5>google</h5>

<p>Indent 2 spaces. No tabs.</p>

<hr />

<h2>${1} - use at most 1 if statement</h2>

<p>I know it sounds crazy; but for consistency and reasons that may become apparent later, do not use if statements unless absolutely necessary.</p>

<h3>How are you supposed to write programs in bash without using more than 1 if statement?</h3>

<p>Use <a href="#test-list-block">the test list block pattern</a> instead; and reserve your only if statement for the program entry.</p>

<h4>the program entry</h4>

<p>Here is what your if statement will look like in every program you write in bash.</p>

<pre><code># program entry for 
# a bash program taking
# no arguments
if [ ! ]
then
 true
else
 exit 1 # wrong args
fi
</code></pre>

<p>Note that the above example is trivial; though if your program takes no arguments, it will do. For bash programs with input the program entry will need to be modified to accomplish what it is your program is set out to do.</p>

<p>For giggles, let's write bash program entry for a program taking 1 argument meant to contain a value for a candidate name.</p>

<pre><code># program entry for 
# a bash program taking
# name 
if [ ${#} -eq 1 ]
then
 name="${1}"
else
 exit 1 # wrong args
fi
</code></pre>

<p>What you do from this point forward is up but please do not write any more if statements. That job is done.</p>

<h4 id="test-list-block">the test lists block pattern</h4>

<h5>test</h5>

<p>test and  [ ] are equivalent</p>

<p>both return false</p>

<p>conversely, test ! and [ ! ] are equivalent</p>

<p>both return true</p>

<h6>examples</h6>

<pre><code>test -f # test a file
</code></pre>

<pre><code>test "${variable}" # test a variable
</code></pre>

<pre><code>test ${number} -eq 0 # test a number
</code></pre>

<h5>lists</h5>

<p>Within the scope of the test list block pattern, a list 2 or more commands or blocks joined by control operators '&amp;&amp;' and '||'. </p>

<h6>examples</h6>

<pre><code>true || {
 this never gets executed
}
</code></pre>

<pre><code>false && {
 this never gets executed either
}
</code></pre>

<h5>block</h5>

<p>Blocks (or groups) in bash allow command grouping in such a way that exit status of the list of commands executed within the block is shared with the block.</p>

<h6>examples</h6>

<pre><code>#
# a block containing lists on one line 
#
{ list ; list ; }
</code></pre>

<pre><code>#
# a block containing list on multiple lines
#
{
 list
 list 
}
</code></pre>

<pre><code>#
# a function definition
#
functions-user-blocks() {
 list
}
</code></pre>

<h5>the test list block pattern in the wild</h5>

<p>Here is how the test list block pattern looks in the wild. </p>

<h6>execute code only if a file exists</h6>

<p>There may come a time when you want to execute a block of code in bash depending on the existence of some file. Here is how.</p>

<pre><code>#
# test list block pattern in the wild
#
test ! -f "${some_file}" || {
 do something with some_file
} 
</code></pre>

<p>See, no ifs ands or buts.</p>

<hr />

<h2>${3} - enclose positional parameters in braces</h2>

<p><code><pre>
cat > test.sh &lt;&lt; EOF
#!/bin/bash
##
## test - positional parameters with and 
##        without braces
##
## version 0.0.1 - initial
##
##################################################
test() {
 #
 # may not work 
 # (GNU bash v4.3.42(5)-release (x86_64-pc-msys) ok
 # 
 echo $1   $11111   # 1234567890 12345678901111 or 1234567890
 #
 # always ok
 #
 echo ${1} ${11111} # 1234567890 11111234567890
}
##################################################
if [ ! ] 
then
 true
else
 exit 1 # wrong args
fi
##################################################
test ${@}
##################################################
EOF
./test.sh {1..11111}234567890
</pre></code></p>

<p>see <a href="https://github.com/temptemp3/test.sh/blob/master/positional-parameters.sh">positional-parameters.sh</a></p>

<p>One of the first things you pick up when getting started writing shell scripts is positional parameters.</p>

<p>Positional parameters contain the values of program or functions arguments.</p>

<p>Your days of using positional parameters without braces as $1 .. $9 in bash are long gone. Not only does it hurt readability, handling positional parameters with $10 and beyond may not work without being enclosed in braces as in ${10}, etc. </p>

<p>To prevent pos-par bugs in your code and improve readability, enclose positional parameters in braces..</p>

<h2>${4} - use functions</h2>

<p>Although you may be tempted to script </p>

<pre><code>#!/bin/bash</code></pre>

<p>through</p>

<pre><code>exit # or just whatever is the last signal</code></pre>

<p>without</p>

<pre><code>having-fun() { ... }</code></pre>

<p>you will find out that not using functions in bash puts you at a disadvantage in terms of error handling and program structure. </p>

<h3>what are functions</h3>

<p>Functions are building blocks in bash that allow you to encapsulate billions of lines of code into a single function call line. </p>

<h4>functions are blocks of code</h4>

<p>A function in bash is a block of code that does not require execution unless called.</p>

<pre><code>fun(){
 some old bash code 
}
# plan on running later</code></pre>

<p>The cannot be said about the following code block.</p>

<pre><code>{
 some young bash code
}
oops! # it ran</code></pre>

<h4>functions are variables</h4>

<p>Functions in bash are variables having the function attribute, which you can check using</p>

<pre><code>declare -f # dump functions</code></pre>

<p>Note that due to the fact that functions are in fact variables, they can be disposed </p>

<pre><code>unset fun # erase fun</code></pre>

<p>or redefined</p>

<pre><code>fun() { 
... 
} # redefine fun</code></pre>

<h4>functions are not aliases</h4>

<p>Aliases are something else.</p>

<h3>what do functions look like</h3>

<p>functions as they should be written ...</p>

<pre><code>template here</code></pre>

<p>functions in the wild ...</p>

<pre><code>natural selection of functions</code></pre>

<h2>${5} - use <code class="w3-codespan">.</code> instead of  <code class="w3-codespan">source</code></h2>

<p><code class="w3-codespan">source</code> is a synonym for the bourne again shell builtin <code class="w3-codespan">.</code>, which can be include the contents of another program and optionally provide arguments. </p>

<p>temptemp3 strictly uses <code class="w3-codespan">.</code> instead of <code class="w3-codespan">source</code> and does not use <code class="w3-codespan">.</code> in a way that results in direct exection; i.e. <em>filename</em> should contain only functions and variables to be used or extended within context of file containing <code class="w3-codespan">. <em>filename</em></code>.</p>

<hr />
<!--.w3-container--></div>
<!--.w3-card--></div>
<!--.w3-col--></div>
<div class="w3-col l4">
<div class="w3-card-2 w3-margin w3-margin-top w3-white">
<div class="w3-container">
<div class="w3-bar w3-white">
<a href="index.html" class="w3-bar-item w3-button w3-mobile">index</a>
<a href="bash-script-coding-style-guide.html" class="w3-bar-item w3-button w3-mobile">bash-script-coding-style-guide</a>
</div> 
<!--.w3-container--></div>
<!--.w3-card--></div>
<!--.w3-col--></div>
<!--.w3-row--></div>
<!-- Grid end -->
<!-- .w3-content --></div>
<footer class="w3-container w3-dark-grey w3-padding-32 w3-margin-top">
<p>&copy; 2017 <a href="https://temptemp3.github.io/">temptemp3.github.io</a></p>
<!--button class="w3-button w3-black w3-disabled w3-padding-large w3-margin-bottom">Previous</button>
<button class="w3-button w3-black w3-padding-large w3-margin-bottom">Next</button-->
<!--mute in global fields -->
<!--p>Powered by <a href="https://www.w3schools.com/w3css/default.asp" target="_blank" rel="nofollow">w3.css</a></p-->
</footer>
</body>
</html>
